# ============================================================================
# Production Requirements - Groq-Only Configuration
# ============================================================================
# Removed:
#   - ollama (Groq-only deployment)
#   - pandas (dev/analysis only)
#   - matplotlib (dev/visualization only)
#
# Note: torch & transformers are REQUIRED for sentence-transformers (BGE embeddings)
# ============================================================================

# --- API & server ---
fastapi>=0.120.0
uvicorn[standard]==0.35.0  # ASGI server (includes uvloop, httptools, websockets)
uvloop==0.21.0              # High-performance event loop
httptools==0.6.4            # Fast HTTP parsing
websockets==13.1            # WebSocket support
httpx==0.28.1               # HTTP client
aiohttp>=3.13.3             # Asynchronous HTTP client/server

# Note: uvicorn is the recommended ASGI server for FastAPI (no gunicorn needed)

# --- RAG stack ---
chromadb==1.0.20
sentence-transformers==5.1.0  # BGE embeddings (requires torch)
groq>=0.4.0                   # Groq LLM API client
redis==5.2.0
rank-bm25==0.2.2              # BM25 keyword search for hybrid retrieval

# --- Core ML deps (REQUIRED for embeddings) ---
# sentence-transformers needs torch for BGE model inference
torch>=2.6.0
transformers==4.55.2

# --- Database ---
sqlalchemy==2.0.25
psycopg2-binary==2.9.9
alembic==1.13.1

# --- Security Fixes ---
starlette>=0.49.1  # CVE-2025-62727
urllib3>=2.6.3     # CVE-2025-50182, CVE-2025-66418, CVE-2026-21441
filelock>=3.20.1   # CVE-2025-68146

# --- Data / utils ---
tqdm==4.67.1
pyyaml==6.0.2
pydantic==2.11.7
python-dotenv==1.1.1
python-multipart==0.0.20
nltk==3.9.1                   # For BM25 tokenization

# --- Metrics ---
prometheus-client==0.22.1
prometheus-fastapi-instrumentator==7.1.0

# --- Authentication ---
passlib[bcrypt]==1.7.4
bcrypt==4.0.1
python-jose[cryptography]==3.4.0  # CVE-2024-33663

# ============================================================================
# Production Savings:
#   - No ollama package (~5MB)
#   - No pandas (~50MB)
#   - No matplotlib (~100MB)
#   - No Ollama service (saves ~5-10GB model storage)
#
# Total image reduction: ~155MB + no model downloads
#
# Note: If Groq fails, app will error (no fallback to Ollama)
# ============================================================================
